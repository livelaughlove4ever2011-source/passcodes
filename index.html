<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>puzzle game 15 numbers</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
body {
    margin:0;
    font-family:"Times New Roman", serif;
    background:#fff0f5;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    height:100vh;
    color:#2a6369;
}

h1 {
    color:#ff66a3;
    margin-bottom:20px;
}

#gameContainer {
    display:grid;
    grid-template-columns:repeat(4,80px);
    grid-gap:10px;
    margin-bottom:20px;
}

.tile {
    width:80px;
    height:80px;
    display:flex;
    align-items:center;
    justify-content:center;
    background:#ffe9f1;
    border-radius:12px;
    font-size:24px;
    font-weight:bold;
    cursor:pointer;
    transition: all 0.2s;
    user-select:none;
}

.tile.empty {
    background:#fff0f5;
    cursor:default;
}

.stats {
    font-size:16px;
    margin-bottom:10px;
}

button {
    background:#2a6369;
    color:#fff;
    border:none;
    padding:10px 20px;
    border-radius:8px;
    cursor:pointer;
    font-weight: bold;
    transition:0.2s;
    font-family: "Times New Roman", Times, serif;
}

button:hover { opacity:0.85; }
</style>
</head>
<body>

<h1>puzzle game</h1>
<div class="stats">moves: <span id="moves">0</span> | time: <span id="time">0</span>s</div>
<div id="gameContainer"></div>
<button onclick="startGame()">restart</button>

<script>
let tiles = [];
let emptyIndex = 15;
let moves = 0;
let seconds = 0;
let timerInterval;

function startGame(){
    clearInterval(timerInterval);
    moves=0; seconds=0;
    document.getElementById("moves").textContent = moves;
    document.getElementById("time").textContent = seconds;
    
    tiles = Array.from({length:15},(_,i)=>i+1);
    shuffle(tiles);
    tiles.push(null);
    emptyIndex = 15;
    
    render();
    timerInterval = setInterval(()=>{seconds++; document.getElementById("time").textContent=seconds;},1000);
}

function shuffle(array){
    // Fisher-Yates
    for(let i=array.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [array[i],array[j]]=[array[j],array[i]];
    }
    // Check solvable
    if(!isSolvable(array)){shuffle(array);}
}

function isSolvable(array){
    let inv=0;
    for(let i=0;i<array.length;i++){
        for(let j=i+1;j<array.length;j++){
            if(array[i] && array[j] && array[i]>array[j]) inv++;
        }
    }
    return inv%2===0;
}

function render(){
    const container = document.getElementById("gameContainer");
    container.innerHTML="";
    tiles.forEach((num,i)=>{
        const div = document.createElement("div");
        div.className="tile";
        if(num===null){div.classList.add("empty");}
        else{div.textContent=num;}
        div.addEventListener("click",()=>moveTile(i));
        container.appendChild(div);
    });
}

function moveTile(i){
    const validMoves = [emptyIndex-1, emptyIndex+1, emptyIndex-4, emptyIndex+4];
    // Check horizontal adjacency
    if(emptyIndex%4===0 && i===emptyIndex-1) return;
    if(emptyIndex%4===3 && i===emptyIndex+1) return;

    if(validMoves.includes(i)){
        [tiles[i], tiles[emptyIndex]]=[tiles[emptyIndex], tiles[i]];
        emptyIndex=i;
        moves++;
        document.getElementById("moves").textContent = moves;
        render();
        checkWin();
    }
}

function checkWin(){
    for(let i=0;i<15;i++){
        if(tiles[i]!==i+1) return;
    }
    clearInterval(timerInterval);
    setTimeout(()=>{alert(`Congrats! You solved it in ${moves} moves and ${seconds} seconds.`);},100);
}

startGame();
</script>

</body>
</html>
